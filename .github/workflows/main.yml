name: 'Flyway Migrate'
 
on:
  push:
    branches:
      - master
 
jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      # Ensure the repository is checked out into the working directory
      - name: Check out repository
        uses: actions/checkout@v2

      # List files in the current directory (which should be the workspace)
      - name: List files in the current directory
        run: ls -R .

      # Run Flyway Migrate
      - name: Run Flyway Migrate
        uses: docker://redgate/flyway:10
        with:
          args: >-
            migrate
            -workingDirectory="/github/workspace/"
            -url="jdbc:sqlserver://sqldocker.database.windows.net:1433;databaseName=SQLDocker_QA;encrypt=true;hostNameInCertificate=*.database.windows.net;loginTimeout=30;trustServerCertificate=false"
            -user="redgate@sqldocker"
            -password="Redg@te1"
